# Qeel Constitution

## Core Principles

### I. 日本語優先

すべてのアウトプット（ユーザとの会話、仕様書・計画書などのMarkdown成果物、実装コードのdocstringやコメント）は**必ず日本語**で記述しなければならない。これにより、プロジェクト全体の一貫性と日本語話者にとっての可読性を確保する。

**理由**: プロジェクトの主要な開発者とステークホルダーが日本語話者であり、コミュニケーションの明確性とドキュメントの保守性を最大化するため。

### II. 可読性最重視（NON-NEGOTIABLE）

コードとドキュメントの**可読性を最優先**する。短縮形や難解な実装より、明確で理解しやすいコードを選択すること。

**必須事項**:
- 変数名・関数名は意図を明確に表現する（略語の使用は最小限に）
- 複雑なロジックには日本語コメントを必須とする
- コードレビューにおいて可読性が最重要な評価基準となる
- 「動けばよい」ではなく「読んで理解できる」ことを優先

**理由**: 長期的な保守性、バグの早期発見、チーム全体の生産性向上のため。

### III. テスト駆動開発（TDD）（NON-NEGOTIABLE）

テスト駆動開発を**厳守**する。Red-Green-Refactorサイクルを必ず守ること。

**必須事項**:
- 実装前に必ずテストを作成する
- テストが失敗することを確認してから実装を開始する
- 包括的なテストカバレッジを維持する
- モックやスタブを適切に利用し、テスタビリティを確保する

**理由**: コードの品質保証、リグレッション防止、仕様の明確化、リファクタリングの安全性確保のため。

### IV. 品質ゲートの遵守（NON-NEGOTIABLE）

実装時は**uv環境でmypy、ruff、pytestを常に実行**し、コード品質を維持しなければならない。

**必須事項**:
- すべてのコード変更後に `uv run mypy` を実行し、型エラーをゼロにする
- すべてのコード変更後に `uv run ruff check` および `uv run ruff format` を実行し、リンターエラーをゼロにする
- すべてのコード変更後に `uv run pytest` を実行し、テストが全件パスすることを確認する
- CIパイプラインでも同じチェックを実行し、PRマージ前にすべてパスすることを必須とする
- これらのチェックをスキップしてコミットしてはならない

**理由**: 開発中に問題を早期発見し、品質の低下を防止するため。自動化されたチェックにより、ヒューマンエラーを排除し、一貫した品質基準を維持する。

### V. パッケージ構造の明確化

Pythonプロジェクトでは**トップレベルパッケージを使用**し、名前空間の衝突を避け、import文を明確にする。

**必須事項**:
- `src/` 配下にプロジェクト固有のトップレベルパッケージを配置する
- すべてのディレクトリに`__init__.py`を配置し、パッケージとして明示する
- 一般的な名前（`clients`, `config`, `utils`等）は必ずトップレベルパッケージ配下に配置する
- import文は絶対importを使用する（例: `from qeel.clients.base import BaseClient`）
- パッケージとして配布可能な構造を維持する（`pyproject.toml`での管理）

**理由**: 名前空間の衝突を防ぎ、プロジェクトの境界を明確にし、他のプロジェクトやライブラリとの統合を容易にするため。

### VI. DRY原則（Don't Repeat Yourself）（NON-NEGOTIABLE）

コードの重複を排除し、**保守性と美しさを最大化**する。同じロジックや知識は単一の場所に定義すること。

**必須事項**:
- 同じコードを複数箇所にコピーペーストしない
- 共通ロジックは関数・クラス・モジュールとして抽出する
- 設定値や定数は一箇所で管理する
- ビジネスルールの重複を避ける（単一責任の原則）
- 抽象化が過剰にならないよう注意する

**理由**: コードの保守性向上、バグの局所化、変更の容易性確保、可読性の向上のため。

### VII. PEP 8準拠（NON-NEGOTIABLE）

Pythonのコーディング規約である**PEP 8を厳守**する。一貫したスタイルによりコードの可読性を確保すること。

**必須事項**:
- インデントは4スペースを使用する
- 命名規則を遵守する（関数・変数: `snake_case`、クラス: `PascalCase`、定数: `UPPER_CASE`）
- import文は標準ライブラリ、サードパーティ、ローカルの順でファイル冒頭に整理する
- linterツール（ruff）を使用し、違反をゼロにする
- フォーマッターツール（ruff format）で自動整形する

**理由**: コードの一貫性確保、チーム全体での可読性向上、レビューコストの削減、Python標準プラクティスへの準拠のため。

## Governance

### 憲章の位置づけ

この憲章はすべての開発プラクティスに優先する。すべてのPR、コードレビュー、設計判断において本憲章への準拠を検証しなければならない。

技術スタック、アーキテクチャ、具体的な実装詳細は憲章の対象外であり、仕様書（Specification）やプロジェクトドキュメントで管理する。

### 修正プロセス

憲章の修正には以下が必要:
- 修正内容の文書化
- 影響を受けるテンプレート・コードの移行計画
- チーム全体の承認

### バージョニングポリシー

- **MAJOR**: 後方互換性のない原則の削除または再定義
- **MINOR**: 新原則・セクションの追加または重要な拡張
- **PATCH**: 明確化、文言修正、誤字修正、非意味的改善

### コンプライアンスレビュー

- すべてのPRは憲章準拠を確認する
- 複雑性の導入は明確に正当化する必要がある
- 実装時の判断に迷った場合はこの憲章を参照する

**Version**: 2.0.0 | **Ratified**: 2025-10-26 | **Last Amended**: 2025-12-07
